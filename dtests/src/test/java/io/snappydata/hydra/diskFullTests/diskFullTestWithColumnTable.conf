hydra.Prms-testRequirement = "Test to verify the cluster stability during diskfull scenario";
hydra.Prms-testDescription = "This test starts the snappy cluster.
    Creates column tables with key columns . After initialization,data is ingested in the cluster using inserts.
    In parallel to the ingestion task , we also execute fallocate command to create files of specific size in order to create the disk full situation.
    In closeTask, the cluster is shutdown ,the pre created files are cleared ,so as to free up disk space.
    Then the cluster is started and validation is done to check if cluster is up and running and that there is no data loss";

INCLUDE $JTESTS/io/snappydata/hydra/northwind/startEmbeddedModeCluster.conf;
//create and load tables
INITTASK    taskClass   = io.snappydata.hydra.cluster.SnappyTest taskMethod  = HydraTask_executeSQLScripts
            io.snappydata.hydra.cluster.SnappyPrms-sqlScriptNames = createAndLoadColumnTable.sql
            threadGroups = snappyThreads;

//Execute continuous ingest operation in batch .
TASK        taskClass  = io.snappydata.hydra.cdcConnector.SnappyCDCTest taskMethod  = HydraTask_executeInserts
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-snappyFileLoc = ${snappyFileLoc}
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-tableType = ${tableType}
            maxTimesToRun = 1
            threadGroups = snappyThreads;

//Execute fallocate in parallel to the ingestion task.
TASK        taskClass   = io.snappydata.hydra.cdcConnector.SnappyCDCTest taskMethod  = HydraTask_executeFallocate
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-fileSize = ${fileSize}
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-snappyFileLoc = ${snappyFileLoc}
            maxThreads = 1
            maxTimesToRun = 3
            startInterval = 120
            endInterval   = 120
            threadGroups = locatorThreads
            ;

CLOSETASK   taskClass  = io.snappydata.hydra.cdcConnector.SnappyCDCTest taskMethod  = HydraTask_executeCleanUpFiles
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-snappyFileLoc = ${snappyFileLoc}
            io.snappydata.hydra.cdcConnector.SnappyCDCPrms-tableType = ${tableType}
            threadGroups = snappyThreads;


// INCLUDE $JTESTS/io/snappydata/hydra/northwind/stopEmbeddedModeCluster.conf;

hydra.Prms-totalTaskTimeSec           = 1200;
hydra.Prms-maxResultWaitSec           = 1200;
io.snappydata.hydra.cluster.SnappyPrms-serverMemory = 4g;

